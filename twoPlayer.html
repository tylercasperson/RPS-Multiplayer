<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rock, Paper, Scissors</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
    

</head>
<body>
    <h2>Instructions: Select r, p, or s. Once you select your option, the computer will let you know it's answer. </h2>
    <div class="container">
        <div class="row">
            <div class="col-md-offset-6 col-md-6">
                <div class="jumbotron jumbotron-fluid">
                    <h3>Current Score: </h3>
                    <h4 class="player1score">Player1: </h4>
                    <h4 class="player2score">Player2: </h4>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <div class="jumbotron">
                    <h2>Player 1 picked <span id="player1"></span></h2>
                    <h2>Player 2 selected <span id="player2"></span></h2>
                    <h2 id="roundScore"></h2>
                </div>
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-database.js"></script>
<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDQbIbuFuRhfmolhdnBfi_jpWyN1ZyNueo",
    authDomain: "rockpaperscissors-d2102.firebaseapp.com",
    databaseURL: "https://rockpaperscissors-d2102.firebaseio.com",
    projectId: "rockpaperscissors-d2102",
    storageBucket: "rockpaperscissors-d2102.appspot.com",
    messagingSenderId: "600671659645",
    appId: "1:600671659645:web:2233d1e8db5293cc54f314",
    measurementId: "G-T8MZKXKGBB"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>

<script type="text/javascript">

var database = firebase.database();

function getScores() {
    var player1spot = $(".player1score");
    var player2spot = $(".player2score");
    var ref = firebase.database().ref();
    ref.on("value", function(snapshot) {
            console.log(snapshot.val());
            console.log(snapshot.val().RPSscore1);
            console.log(snapshot.val().RPSscore2);
            var pastPlayer1Score = snapshot.val().RPSscore1;
            var pastPlayer2Score = snapshot.val().RPSscore2;
            player1spot.text('Player1: ' + pastPlayer1Score);
            player2spot.text('player2: ' + pastPlayer2Score);
        }, function (error) {  
        console.log("Error: " + error.code);
    }) //end of error and get data
};
getScores();

var whoWon = [];
var bestOfThree = [];
var turn = [];

function userSelection(player) {
    if(player === 'player1'){ 
        var userText = document.getElementById("player1");
        playerIndex = 0;
        console.log('1');
    } else if (player === 'player2') {
        var userText = document.getElementById("player2");
        playerIndex = 1;
        console.log('2');
    }

    document.onkeyup = function(event) {

        switch(event.key){
            case 'r':
            case '1':
                userText.textContent = 'rock';
            break;
            case 'p':
            case '2':
                userText.textContent = 'paper';
            break;
            case 's':
            case '3':
                userText.textContent = 'scissors';
            break;
        }

        var player1selection = document.getElementById("player1").innerText;
        if(event.key === 'r' || 's' || 'p' || '1' || '2' || '3'){
            userSelection('player2');
            var player2selection = document.getElementById("player2").innerText;
            turn[0] = player1selection;
            turn[1] = player2selection;
            bestOfThree.push(turn);
            console.log(turn);
            score(player1selection, player2selection);
            writeData();

            }
                
            function writeData() {
                database.ref().set({
                    RPSscore1: 4,
                    RPSscore2: 4
                    }); //end of set
            }  //end of write data
        }
};
    userSelection('player1');

function getData() {
    var ref = firebase.database().ref();

    ref.on("value", function(snapshot) {
        console.log(snapshot.val());
        console.log(snapshot.val().RPSscore1);
    }, function (error) {
    console.log("Error: " + error.code);
    });
}

    function score(player1selection, player2selection) {
        
        var scoreMessage = {
            'rock-paper': 'Point goes to player 2.',
            'rock-scissors': 'Point goes to player 1.',
            'rock-rock': 'There was a tie.',
            'paper-rock': 'Point goes to player 1.',
            'paper-scissors': 'Point goes to player 2.',
            'paper-paper': 'There was a tie.',
            'scissors-rock': 'Point goes to player 2.',
            'scissors-paper': 'Point goes to player 1.',
            'scissors-scissors': 'There was a tie.'
        }

        var scoreBreakdown = {
            'rock-paper': '2',
            'rock-scissors': '1',
            'rock-rock': '0',
            'paper-rock': '1',
            'paper-scissors': '2',
            'paper-paper': '0',
            'scissors-rock': '2',
            'scissors-paper': '1',
            'scissors-scissors': '0'
        }

        document.getElementById("roundScore").textContent = (scoreMessage[player1selection + '-' + player2selection]);    
        whoWon.push(scoreBreakdown[player1selection + '-' + player2selection]);
        console.log(whoWon);
        
    };

    // if (scoreBreakdown[player1selection + '-' + player2selection] === '1') {
    //     //firebase push score to player 1
    //     //if after score is pushed to player 1 then it displays you won
    // } else if (scoreBreakdown[player1selection + '-' + player2selection] === '2'){
    //     //firebase push score to player 2
    // }

    //go through the rounds to use the reset function

    function reset() {
        document.getElementById("player1").innerText = '';
        document.getElementById("player2").innerText = '';
        document.getElementById("roundScore").textContent = '';
    }
    

    //https://ultimatecourses.com/blog/deprecating-the-switch-statement-for-object-literals



    //add second player version. 
    //switch statement to determine who won.
    //firebase will keep track of the score
    //random variable for chat functionality
</script>
</body>
</html>